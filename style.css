/* 1. Define Variables (Light Mode Default) */
:root {
  --bg-color: #eeeeee;
  --text-color: #222222;
  --btn-bg: #ffffff;
  --btn-text: #000000;
  --btn-shadow: rgba(0, 0, 0, 0.16);
  --btn-hover: #ffa;
  --btn-success: #afa;
  --btn-error: #faa;
  --border-color: #888;
  --toggle-text-light: #1ac222; /* Green for active light label */
  
  /* Toggle Switch Colors */
  --switch-bg: rgba(34, 31, 31, 0.26);
  --knob-bg: #f1f1f1;
}

/* 2. Define Dark Mode Variables */
body.dark {
  --bg-color: #121212;
  --text-color: #e0e0e0;
  --btn-bg: #2c2c2c;
  --btn-text: #ffffff;
  --btn-shadow: rgba(0, 0, 0, 0.5);
  
  /* Muted Status Colors for Dark Mode */
  --btn-hover: #555540;
  --btn-success: #1e4d1e;
  --btn-error: #5a1e1e;
  
  --border-color: #555;
  
  /* Toggle Switch Colors Dark */
  --switch-bg: rgba(255, 255, 255, 0.3);
  --knob-bg: #222;
}

/* Light material design boilerplate. */
html,
body {
  width: 100%;
  margin: 0;
  padding: 0;
  background: var(--bg-color);
  color: var(--text-color);
  transition: background 0.3s, color 0.3s;
}

/* Only apply min-height to non-print media */
@media not print {
  html,
  body {
    min-height: 100%;
  }
}

body {
  font-family: Verdana, Helvetica, sans-serif;
  text-align: center;
  box-sizing: border-box;
  padding: 2em;
  display: flex;
  flex-direction: column;
}

.content {
  align-self: center;
}

.before {
  flex: 1 1 5%;
}

.after {
  flex: 2 2 10%;
}

button {
  background: var(--btn-bg);
  color: var(--btn-text);
  border: none;
  font-size: 1.5em;
  width: 400px;
  padding: 0.5em;
  margin: 10px 10px;
  box-shadow: 0 3px 6px var(--btn-shadow), 0 3px 6px var(--btn-shadow);
  transition: all 150ms;
}

button:hover {
  background: var(--btn-hover);
  cursor: pointer;
  box-shadow: 0 10px 20px var(--btn-shadow), 0 6px 6px var(--btn-shadow);
  transform: translateY(-2px);
}

button.success {
  background: var(--btn-success);
}

button.error {
  background: var(--btn-error);
}

table {
  margin: 1em auto;
  border-collapse: collapse;
}

table td {
  border: 1px solid var(--border-color);
  padding: 8px;
}

table td:first-child {
  text-align: right;
}

#toggle-wrapper {
  display: block;
  margin: 2em 0 3em;
}

#toggle {
  font-size: 1.5em;
  padding: 1em;
  margin: 1em;
  color: var(--text-color);
  text-decoration: none;
}

#toggle .http,
#toggle .https {
  color: rgba(0, 0, 0, 0.5);
  transition: color 0.25s ease-in-out;
}

/* ================================================== */
/* FIX: Make inactive labels visible in Dark Mode     */
/* ================================================== */
body.dark #toggle .http,
body.dark #toggle .https {
  color: rgba(255, 255, 255, 0.5);
}

#toggle.https .http,
#toggle.http .https {
  color: rgba(0, 0, 0, 0.5);
}

/* Override the dark mode fix specifically for the 'inactive' state logic in the original CSS
   actually, we can just rely on the specificity of the ID selectors below to color the ACTIVE ones,
   and let the rule above color the INACTIVE ones. 
*/

#toggle.http:not(:hover) .http {
  color: #db4437;
}

#toggle.https:not(:hover) .https {
  color: #1ac222;
}

#toggle.http:hover .https {
  text-decoration: underline;
  color: #1ac222;
}

#toggle.https:hover .http {
  text-decoration: underline;
  color: #db4437;
}

a#toggle:hover {
  color: var(--text-color);
}

.switch {
  display: inline-block;
  width: 34px;
  height: 14px;
  border-radius: 7px;
  background-color: var(--switch-bg);
  margin: auto 0.5em;
  transition: background-color 0.25s ease-in-out;
}

.switch .knob {
  width: 20px;
  height: 20px;
  margin: -3px;
  border-radius: 10px;
  background-color: var(--knob-bg);
  border: inset 0.5px rgba(255, 255, 255, 0.12), inset 0.5px
    rgba(255, 255, 255, 0.12);
  box-shadow: 0px 0px 2px 0px rgba(0, 0, 0, 0.12), 0px 2px 2px 0px
    rgba(0, 0, 0, 0.24);

  transform: translateX(10px);
  transition: transform 0.25s ease-in-out, background-color 0.25s ease-in-out;
}

#toggle.instant .switch,
#toggle.instant .switch .knob,
#toggle.instant .http,
#toggle.instant .https {
  transition: transform 0s;
}

.http:not(:hover) .switch,
.https:hover .switch {
  background-color: rgba(219, 68, 55, 0.26);
}

.http:not(:hover) .switch .knob,
.https:hover .switch .knob {
  background-color: rgb(219, 68, 55);
  transform: translateX(0px);
}

.http:hover .switch,
.https:not(:hover) .switch {
  background-color: rgba(29, 194, 34, 0.5);
}

.http:hover .switch .knob,
.https:not(:hover) .switch .knob {
  background-color: rgb(29, 194, 34);
  transform: translateX(20px);
}

.jswarning {
  color: rgb(219, 68, 55);
  font-size: 2em;
}

.permission-status,
.access-status {
  font-size: small;
  text-transform: uppercase;
  padding-top: .4rem;
  text-align: left;
}

.permission-status > span,
.access-status > span {
  font-weight: 800;
}

.demo-instructions {
  padding: .5rem 1rem;
  text-align: left;
  border: solid 1px var(--border-color);
  max-width: 80rem;
  align-self: center;
  margin: 1rem auto;
}

permission {
  position: relative;
  background: #def0ff;
  border: solid #005763;
  border-radius: 5px;
  width: 400px;
  padding: 0.5em;
  margin: 10px 10px;
  z-index: 99999;
  /* github-fork-ribbon-wrapper uses 9999 */
}

.permission-element-box {
  display: inline-block;
}

geolocation {
  display: inline-block;
  padding: 8px 12px;
  border: 1px solid #ccc;
  border-radius: 4px;
  background-color: #f0f0f0;
  cursor: pointer;
  user-select: none;
}

geolocation:hover {
  background-color: #e0e0e0;
}

.geolocation-event-logger {
  font-family: monospace;
  border: 1px solid #ddd;
  padding: 15px;
  margin-top: 10px;
  background-color: #fafafa;
  min-height: 80px;
  white-space: pre-wrap;
}

/* ============================ */
/* New Theme Toggle Styles   */
/* ============================ */

#theme-toggle-wrapper {
  /* Move from center flow to top-left corner */
  position: absolute;
  top: 1rem;
  left: 1rem;
  margin: 0;
  z-index: 1000;
}

/* On very small mobile screens, ensure it doesn't overlap content */
@media (max-width: 500px) {
  #theme-toggle-wrapper {
    position: static; /* Return to normal flow on tiny screens */
    display: block;
    margin: 1em auto;
    text-align: center;
  }
}

#theme-toggle {
  font-size: 1rem; /* Slightly smaller to fit the corner better */
  padding: 0.4em;
  margin: 0;
  color: var(--text-color);
  text-decoration: none;
  display: inline-flex; /* Aligns text and switch nicely */
  align-items: center;
}

#theme-toggle .light-label,
#theme-toggle .dark-label {
  color: rgba(0,0,0,0.6);
  transition: color 0.25s ease-in-out;
  font-size: 0.9em;
}

/* In dark mode, brighten the inactive labels */
body.dark #theme-toggle .light-label,
body.dark #theme-toggle .dark-label {
  color: rgba(255,255,255,0.6);
}

/* Active State Colors */
body:not(.dark) #theme-toggle .light-label {
  color: var(--toggle-text-light);
  font-weight: bold;
}

body.dark #theme-toggle .dark-label {
  color: var(--toggle-text-light);
  font-weight: bold;
}

#theme-toggle .switch {
  display: inline-block;
  width: 34px;
  height: 14px;
  border-radius: 7px;
  background-color: rgba(128, 128, 128, 0.3);
  margin: 0 0.5em; /* Adjusted margin for corner layout */
  position: relative;
}

#theme-toggle .switch .knob {
  width: 20px;
  height: 20px;
  margin-top: -3px;
  border-radius: 50%;
  background-color: #f1f1f1;
  box-shadow: 0 1px 3px rgba(0,0,0,0.4);
  transition: transform 0.25s ease-in-out, background-color 0.25s;
  position: absolute;
  left: 0;
  border: none;
}

/* Switch Animation States */
body:not(.dark) #theme-toggle .switch .knob {
  transform: translateX(0px);
}

body.dark #theme-toggle .switch .knob {
  transform: translateX(20px);
  background-color: #29a329;
}